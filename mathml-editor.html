<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MathML 수식 건설</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
    <style>
        body {
            background-color: #f8fafc;
            color: #1e293b;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
    </style>
</head>
<body class="antialiased">

    <!-- Header / Navbar Placeholder -->
    <header class="bg-white border-b border-slate-200 p-4">
        <div class="max-w-5xl mx-auto flex justify-between items-center">
            <h1 class="text-xl font-bold text-slate-800">MathML 수식 건설</h1>
            <nav class="space-x-4 text-sm font-medium text-slate-600">
                <a href="#" class="hover:text-blue-600 transition">홈</a>
                <a target="_blank" href="https://www.w3.org/TR/MathML/chapter3.html" class="hover:text-blue-600 transition">요소</a>
                <a target="_blank" href="http://www.w3.org/1998/Math/MathML" class="hover:text-blue-600 transition">네임스페이스</a>
            </nav>
        </div>
    </header>

    <!-- Main Content Area -->
    <main class="flex-grow flex items-center justify-center p-6">
        <div class="text-center bg-white p-12 rounded-2xl shadow-sm border border-slate-200 w-[80%]">
            <div class="border-2 rounded-[5px] py-[10px] bg-neutral-400 text-neutral-500 border-neutral-500 text-[13px]">
            	<label for="mathmlInput" class="uppercase font-semibold">MathML 입력</label><br>
                <textarea id="mathmlInput" class="font-mono text-[13px] bg-zinc-800 border-2 border-black rounded-[5px] w-[90%] h-[200px] text-teal-400 resize-none"><math><semantics><msqrt><mn>2</mn></msqrt><annotation encoding="application/x-tex">mathjax annotation text</annotation></semantics></math></textarea>
            </div><br>
            <button id="renderButton" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium transition-colors">
                렌더
            </button><br>
            <div class="border-2 rounded-[5px] py-[10px] bg-neutral-400 text-neutral-500 border-neutral-500 text-[13px]">
            	<label for="mathmlInput" class="uppercase font-semibold">MathML 결과</label><br>
                <div id="mathmlOutput" class="inline-block text-[1.5rem] bg-zinc-800 border-2 border-black rounded-[5px] w-[90%] h-[200px] text-white text-left">MathML 입력...</div>
            </div>
        </div>
    </main>

    <!-- Footer Placeholder -->
    <footer class="p-6 text-center text-slate-400 text-xs">
        &copy; 2026 MathML 수식 건설. HTML5와 Tailwind 이용.
    </footer>

    <script>
        const mathmlInput = document.getElementById('mathmlInput');
        const mathmlOutput = document.getElementById('mathmlOutput');
        const renderButton = document.getElementById('renderButton');
        
        function waitUntil(condition) {
            return new Promise(resolve => window.setInterval(async () => {
                if (await condition()) {
                    resolve();
                }
            }, 0));
        }
        
        let currentTimeout;
        
        function stringToDom(stringInput) {
            const div = document.createElement('div');
            div.innerText = stringInput;
            return div.innerHTML;
        }
        
        function renderMathML(mathmlString) {
            if (mathmlString.trim() == '') {
                mathmlOutput.innerHTML = 'MathML 입력...';
            } else {
                mathmlOutput.innerHTML = mathmlString;
                MathJax.typesetPromise([mathmlOutput])
                    .catch((error) => {
                        mathmlOutput.innerHTML = `<span class="text-red-500">${stringToDom(error)}</span>`;
                    })
            }
        }
        
        const manualRender = () => {
            const mathml = mathmlInput.value.trim();
            renderMathML(mathml);
        };
        
        function inputHandler() {
            if (currentTimeout) {
                window.clearTimeout(currentTimeout);
            }
            currentTimeout = window.setTimeout(manualRender, 750);
        }
        
        mathmlInput.addEventListener('input', inputHandler);
        renderButton.addEventListener('click', manualRender);
        
        waitUntil(async () => {
            try {
                let temp = MathJax;
                return true;
            } catch (error) {
                return false;
            }
        }).then(() => manualRender());
    </script>
</body>
</html>
